!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.VueCoreImageUpload=e():t.VueCoreImageUpload=e()}(this,function(){return function(t){function e(a){if(o[a])return o[a].exports;var r=o[a]={i:a,l:!1,exports:{}};return t[a].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var o={};return e.m=t,e.c=o,e.i=function(t){return t},e.d=function(t,o,a){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:a})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=12)}({12:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={_getImageType:function(t){var e="image/jpeg",o=t.match(/(image\/[\w]+)\.*/)[0];return void 0!==o&&(e=o),e},compress:function(t,e){var o=new FileReader,a=t.name,r=(t.type,t.size),n=this;console.log(t),o.onload=function(o){var i=new Image;i.src=o.target.result,i.onload=function(){var o=i.height,g=i.width,u=void 0,m=void 0;if(o>1280||g>1280){var s=o/g;o>=g?(u=1280,m=Math.round(1280/s)):(m=1280,u=Math.round(1280*s))}else u=o,m=g;console.log(u,m);var c=void 0,p=1,d=n._getImageType(t.type);do{var f=n._getCanvas(m*p,u*p);f.getContext("2d").drawImage(i,0,0,m*p,u*p);c=f.toDataURL(d);for(var l=window.atob(c.split(",")[1]),v=new ArrayBuffer(l.length),h=new Uint8Array(v),I=0;I<l.length;I++)h[I]=l.charCodeAt[I];var C=new File([h],a,{type:d});console.log(C),r=C.size,p-=.1}while(r>1024e3);console.log(c),e(c)}},o.readAsDataURL(t)},crop:function(t,e,o){var a=function(t){return"number"==typeof t};if(a(e.toCropImgX)&&a(e.toCropImgY)&&e.toCropImgW>0&&e.toCropImgH>0){var r=e.toCropImgW,n=e.toCropImgH;e.maxWidth&&e.maxWidth<r&&(r=e.maxWidth,n=e.toCropImgH*r/e.toCropImgW),e.maxHeight&&e.maxHeight<n&&(n=e.maxHeight);var i=this._getCanvas(r,n),g=(i.getContext("2d").drawImage(t,e.toCropImgX,e.toCropImgY,e.toCropImgW,e.toCropImgH,0,0,r,n),this._getImageType(t.src));o(i.toDataURL(g,e.compress/100))}},init:function(t,e){var o=new Image;o.src=t;var a=this;o.onload=function(){var t=a._getImageType(o.src),r=a._getCanvas(o.naturalWidth,o.naturalHeight);r.getContext("2d").drawImage(o,0,0);var n=r.toDataURL(t,100);e(n)}},rotate:function(t,e,o){var a=new Image;a.src=t.src;var r=this;a.onload=function(){var t=r._getImageType(a.src),n=r._getCanvas(a.naturalHeight,a.naturalWidth),i=n.getContext("2d");1==e?(i.rotate(90*Math.PI/180),i.translate(0,-n.width)):(i.rotate(-90*Math.PI/180),i.translate(-n.height,0)),i.drawImage(a,0,0);var g=n.toDataURL(t,100);o(g)}},resize:function(t,e,o){var a=function(t){return"number"==typeof t};if(a(e.toCropImgX)&&a(e.toCropImgY)&&e.toCropImgW>0&&e.toCropImgH>0){var r=e.toCropImgW*e.imgChangeRatio,n=e.toCropImgH*e.imgChangeRatio,i=this._getCanvas(r,n),g=(i.getContext("2d").drawImage(t,0,0,e.toCropImgW,e.toCropImgH,0,0,r,n),this._getImageType(t.src));o(i.toDataURL(g,e.compress/100))}},rotate2:function(t,e,o){var a=this;this._loadImage(t,function(r){var n=r.naturalWidth,i=r.naturalHeight,g=Math.max(n,i),u=a._getCanvas(g,g),m=u.getContext("2d");m.save(),m.translate(g/2,g/2),m.rotate(e*(Math.PI/180));var s=-g/2,c=-g/2;if(0===(e%=360))return o(t,n,i);if(e%180!=0){-90===e||270===e?s=g/2-n:c=g/2-i;var p=n;n=i,i=p}else s=g/2-n,c=g/2-i;m.drawImage(r,s,c),a._getCanvas(n,i).getContext("2d").drawImage(u,0,0,n,i,0,0,n,i);var d=a._getImageType(r.src),f=u.toDataURL(d,1);o(f,n,i)})},_loadImage:function(t,e){var o=new Image;o.src=t,o.onload=function(){e(o)},o.onerror=function(){console.log("Error: image error!")}},_getCanvas:function(t,e){var o=document.createElement("canvas");return o.width=t,o.height=e,o}}}})});